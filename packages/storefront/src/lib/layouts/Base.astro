---
import type CmsCode from '../../types/cms-code';
import type { PageContext } from '../ssr-context';
import BaseHead from './BaseHead.astro';
import BaseStateJson from './BaseStateJson.astro';
import BaseBody from './BaseBody.astro';

export interface Props {
  pageContext: PageContext;
  title?: string;
}

const { pageContext, title } = Astro.props as Props;
const { cms } = pageContext;
const cmsCustomCode = cms('code') as CmsCode;
---

<head>
  <BaseHead pageContext={pageContext} title={title} />
  <BaseStateJson pageContext={pageContext} />
  <slot name="before-head-end">
    {cmsCustomCode.css && <style>{cmsCustomCode.css}</style>}
    {cmsCustomCode.html_head && <Fragment set:html={cmsCustomCode.html_head} />}
  </slot>
</head>
<BaseBody pageContext={pageContext}>
  <slot />
  <slot name="before-body-end">
    {cmsCustomCode.html_body && <Fragment set:html={cmsCustomCode.html_body} />}
  </slot>
</BaseBody>
